!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("infestines"),require("partial.lenses")):"function"==typeof define&&define.amd?define(["exports","infestines","partial.lenses"],r):r(n.V={},n.I,n.L)}(this,function(n,r,t){"use strict";function e(n){this.value=void 0!==n?n:null}function u(n){var r=Error(JSON.stringify(n,null,2));return r.errors=n,r}function i(n){throw u(n)}function o(n,r){var t=J;return t===w?t=r:J=w,n.of(N(t))}function c(n){n=t.toFunction(n);for(var e=arguments.length,u=Q;--e;){var i=arguments[e];u=1!==f(i)?T(L(i[0]),V(i[1]),u):r.always(V(i[0]))}return function(r,e,i,o){return n(r,e,t.Constant,u)(r,e,i,o)}}var f=function(n){return n.length},a=r.curry(function(n,r){return n<=r}),s=r.curry(function(n,r){return r instanceof n}),l=s(Object),y=r.curry(function(n,r){return function(t){return n(r(t))}}),p=r.curry(function(n,r){return function(t){return n(t)&&r(t)}}),d=Promise,v=d.reject.bind(d),h=d.resolve.bind(d),m=function(n,t){return null!=(e=t)&&r.isFunction(e.then)?t.then(n):n(t);var e},A=(0,r.id)({map:m,ap:function(n,r){return m(function(r){return m(function(n){return n(r)},n)},r)},of:r.id,chain:m}),w={},g=function(n){return n===w?void 0:n},j=function(n){return void 0!==n?n:w},O=t.rewrite(function(n){var r=b(n);return r&&(n=E(n)),n=n.map(g),r?N(n):n}),F=function(n,r,t,e){return t.map(j,e(n,r))},b=s(e),N=(0,r.id)(function(n){return new e(n)}),E=function(n){return n.value},x=function(n){return b(n)?E(n):void 0},I=function(n,r){return function(e){return t.any(b,n,e)?N(t.modify(n,r,e)):e}},z=t.rewrite(I(t.elems,function(n){return b(n)?E(n):null})),M=t.rewrite(I(t.elems,x)),q=t.rewrite(I(t.values,x)),P=function(n){return b(n)?i(u(E(n))):n},R=function(n,r,t){return function(){var e=arguments.length,u=n;if(e)for(u=r(arguments[--e],u);e;)u=t(arguments[--e],u);return u}},V=function(n){if(r.isFunction(n))return f(n)<3?on(n):n;var t=n[1];return r.isFunction(t)?cn(t,n[0]):fn(t,n[0])},W=function(n,r){return t.ifElse(n,_(r),H)},_=y(t.toFunction,t.modify(t.elems,V)),k=function(n){var e=n.less,u=n.rest;return u=V(u),function(){for(var n=[],i=arguments.length,o=0;o<i;++o)n.push(V(arguments[o]));return W(e?r.isArray:p(r.isArray,y(a(i),f)),[O,z,e?function(n,r,e,u){var o=f(n);return o<i?((n=n.slice()).length=i,e.map(function(n){return t.any(b,t.elems,n)?n:n.slice(0,o)},t.elems(n,r,e,u))):t.elems(n,r,e,u)}:t.elems,F,t.choose(function(r,t){return n[t]||u})])}},C=function(n,r,t){return Y({Monad:n,onAccept:r,onReject:t})},J=w,L=function(n,r){return function(t,e){try{return n(t,e)}catch(n){return J=n,r}}},S=t.zero,B=function(n){return function(r,t,e,u){return u(n,t)}},D=function(n){return function(r,t,e,u){return e.chain(function(n){return u(n,t)},n(r,t))}},G=y(t.setOp,N),H=t.modifyOp(N),K=B(void 0),Q=r.always(H),T=function(n,r,t){return function(e,u){return function(i,c,f,a){return f.chain(function(n){return n?r(i,c,f,a):void 0!==n||J===w?t(e,u)(i,c,f,a):o(f,i)},n(e,u))}}},U=function(n){return r.curryN(2,function(r){return r=V(r),function(t){return t=V(t),n(r,t)}})},X=function(n){return function(r){return 3===f(r)?[r[0],ln(an(r[1],r[2]),n)]:r}},Y=r.curryN(3,function(n){var e=n.Monad||t.Identity,u=n.onAccept||r.id,o=n.onReject||i,c=function(n){return b(n)?o(E(n)):u(n)};return function(n){return n=V(n),function(u){return e.chain(c,t.traverse(e,r.id,n,u))}}}),Z=C(0,r.always(!0),r.always(!1)),$=C(0,function(n){},r.id),nn=C(),rn=C(A,r.always(h(!0)),r.always(h(!1))),tn=C(A,r.always(h()),h),en=C(A,0,y(i,u)),un=C(A,h,y(v,u)),on=function(n){return n=L(n),function(r,t,e,u){return e.chain(function(n){return n?e.of(r):o(e,r)},n(r,t))}},cn=r.curry(function(n,r){return r=V(r),function(t,e,u,i){return u.chain(function(r){return b(r)?u.map(N,n(t,E(r),e)):u.of(r)},r(t,e,u,i))}}),fn=r.curry(function(n,r){return _([t.rewrite(function(r){return b(r)?N(n):r}),r])}),an=r.curryN(2,function(n){return y(ln(n),D)}),sn=r.curryN(2,function(n){return y(ln(n),B)}),ln=U(function(n,r){return function(t,e,u,i){return u.chain(function(n){return b(n)?u.of(n):r(n,e,u,i)},n(t,e,u,i))}}),yn=R(S,V,ln),pn=U(function(n,r){return function(t,e,u,i){return u.chain(function(n){return b(n)?r(t,e,u,i):u.of(n)},n(t,e,u,i))}}),dn=R(H,V,pn),vn=k({less:!0,rest:S}),hn=k({less:!1,rest:H}),mn=r.curry(function(n,e){return n=V(n),function(o,c,f,a){return f.of(r.isFunction(o)?function(){for(var c=arguments.length,a=Array(c),s=0;s<c;s++)a[s]=arguments[s];return f.chain(function(n){return b(n)?i(u(E(n))):f.chain(function(u){return f.map(P,t.traverse(f,r.id,V(e.apply(null,n)),u))},o.apply(null,n))},t.traverse(f,r.id,n,a))}:N(o))}}),An=r.curry(function(n,t){return mn(n,r.always(t))}),wn=r.curry(function(n,r){return W(l,[t.setter(function(r,e){return b(r)?N(t.set(n,function(n,r,e){return void 0!==(r=t.get(n,r))?r:t.get(n,e)}(n,E(r),e),E(r))):r}),r])}),gn=r.curry(function(n,r){return W(l,[q,t.branchOr(V(n),t.modify(t.values,V,r))])}),jn=gn(H),On=R(H,function(n,r){return 1===f(n)?n[0]:Fn(n[0],n[1],r)},function(n,r){return Fn(n[0],n[1],r)}),Fn=r.curry(function(n,r,t){return n=L(n),r=V(r),t=V(t),function(e,u,i,c){return i.chain(function(n){return n?r(e,u,i,c):void 0!==n||J===w?t(e,u,i,c):o(i,e)},n(e,u))}}),bn=y(t.lazy,y(V)),Nn=function(n){return n},En=Nn(S),xn=Nn(B),In=Nn(D),zn=Nn(function(n){return function(r,t,e,u){return e.map(N,n(r,t))}}),Mn=Nn(G),qn=Nn(H),Pn=Nn(K),Rn=Nn(Y),Vn=Nn(Z),Wn=Nn($),_n=Nn(nn),kn=Nn(rn),Cn=Nn(tn),Jn=Nn(en),Ln=Nn(un),Sn=Nn(on),Bn=Nn(cn),Dn=Nn(fn),Gn=Nn(an),Hn=Nn(sn),Kn=Nn(function(n){return ln(n,K)}),Qn=Nn(ln),Tn=Nn(yn),Un=Nn(function(n){return _([t.setter(function(n,r){return b(n)?r:N(r)}),n])}),Xn=Nn(pn),Yn=Nn(dn),Zn=Nn(function(n){return W(r.isArray,[M,t.elems,n])}),$n=Nn(function(n){return W(r.isArray,[z,t.elems,n])}),nr=Nn(vn),rr=Nn(hn),tr=Nn(mn),er=Nn(An),ur=Nn(wn),ir=Nn(function(n){return _([t.optional,n])}),or=Nn(gn),cr=Nn(jn),fr=Nn(function(n){return n=L(n),function(r,t,e,u){return e.chain(function(n){return n?V(n)(r,t,e,u):o(e,r)},n(r,t))}}),ar=Nn(On),sr=Nn(Fn),lr=Nn(c),yr=Nn(bn),pr=Nn(function(){for(var n=arguments.length,r=Array(n),t=0;t<n;t++)r[t]=arguments[t];return bn(function(n){return dn.apply(null,r.map(function(r){return 2===f(r)?ln(an(r[0],r[1]),n):r[0]}))})}),dr=Nn(function(){for(var n=arguments.length,r=Array(n),t=0;t<n;t++)r[t]=arguments[t];return bn(function(n){return On.apply(null,r.map(X(n)))})}),vr=Nn(function(n){for(var r=arguments.length,t=Array(r>1?r-1:0),e=1;e<r;e++)t[e-1]=arguments[e];return bn(function(r){return c.apply(null,[n].concat(t.map(X(r))))})});n.accept=En,n.acceptAs=xn,n.acceptWith=In,n.rejectWith=zn,n.rejectAs=Mn,n.reject=qn,n.remove=Pn,n.run=Rn,n.accepts=Vn,n.errors=Wn,n.validate=_n,n.acceptsAsync=kn,n.errorsAsync=Cn,n.tryValidateAsyncNow=Jn,n.validateAsync=Ln,n.where=Sn,n.modifyError=Bn,n.setError=Dn,n.modifyAfter=Gn,n.setAfter=Hn,n.removeAfter=Kn,n.both=Qn,n.and=Tn,n.not=Un,n.either=Xn,n.or=Yn,n.arrayId=Zn,n.arrayIx=$n,n.args=nr,n.tuple=rr,n.dependentFn=tr,n.freeFn=er,n.keep=ur,n.optional=ir,n.propsOr=or,n.props=cr,n.choose=fr,n.cases=ar,n.ifElse=sr,n.casesOf=lr,n.lazy=yr,n.promote=pr,n.upgrades=dr,n.upgradesOf=vr,Object.defineProperty(n,"__esModule",{value:!0})});
