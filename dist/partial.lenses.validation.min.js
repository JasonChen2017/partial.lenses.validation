!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("infestines"),require("partial.lenses")):"function"==typeof define&&define.amd?define(["exports","infestines","partial.lenses"],r):r(n.V={},n.I,n.L)}(this,function(n,r,t){"use strict";function e(n){this.value=void 0!==n?n:null}function u(n){var r=Error(JSON.stringify(n,null,2));return r.errors=n,r}function i(n){throw u(n)}var o=function(n){return n.length},c=r.curry(function(n,r){return n<=r}),f=r.curry(function(n,r){return r instanceof n}),a=f(Object),s=r.curry(function(n,r){return function(t){return n(r(t))}}),l=r.curry(function(n,r){return function(t){return n(t)&&r(t)}}),y=t.transform(function(n,r,t,e){return t},0),d=Promise,p=d.reject.bind(d),h=d.resolve.bind(d),v=function(n,t){return null!=t&&r.isFunction(t.then)?t.then(n):n(t)},m={map:v,ap:function(n,r){return v(function(r){return v(function(n){return n(r)},n)},r)},of:r.id,chain:v},w={},A=function(n){return n===w?void 0:n},g=function(n){return void 0===n?w:n},j=t.rewrite(function(n){var r=O(n);return r&&(n=E(n)),n=n.map(A),r?b(n):n}),F=function(n,r,t,e){return t.map(g,e(n,r))},O=f(e),b=r.id(function(n){return new e(n)}),E=function(n){return n.value},x=function(n){return O(n)?E(n):void 0},z=function(n,r){return function(e){return t.any(O,n,e)?b(t.modify(n,r,e)):e}},I=t.rewrite(z(t.elems,function(n){return O(n)?E(n):null})),M=t.rewrite(z(t.elems,x)),N=t.rewrite(z(t.values,x)),q=function(n){return O(n)?i(u(E(n))):n},P=function(n,r,t){return function(){var e=arguments.length,u=n;if(e)for(u=r(arguments[--e],u);e;)u=t(arguments[--e],u);return u}},R=r.id(function(n){if(r.isFunction(n))return o(n)<3?Z(n):n;var t=n[1];return r.isFunction(t)?$(t,n[0]):nn(t,n[0])}),V=function(n,r){return t.ifElse(n,W(r),X)},W=s(t.toFunction,t.modify(t.elems,R)),_=function(n){var e=n.less,u=n.rest;return u=R(u),function(){for(var n=[],i=arguments.length,f=0;f<i;++f)n.push(R(arguments[f]));return V(e?r.isArray:l(r.isArray,s(c(i),o)),[j,I,e?function(n,r,e,u){var c=o(n);return c<i?((n=n.slice()).length=i,e.map(function(n){return t.any(O,t.elems,n)?n:n.slice(0,c)},t.elems(n,r,e,u))):t.elems(n,r,e,u)}:t.elems,F,t.choose(function(r,t){return n[t]||u})])}},k=function(n,r,t){return L({Monad:n,onAccept:r,onReject:t})},J=!1,L=r.curryN(3,function(n){var e=n.Monad||y,u=n.onAccept||r.id,o=n.onReject||i,c=function(n){return O(n)?o(E(n)):u(n)};return function(n){return n=R(n),function(u){return e.chain(c,t.traverse(e,r.id,n,u))}}}),S=k(0,r.always(!0),r.always(!1)),B=k(0,function(n){},r.id),C=k(),D=k(m,r.always(h(!0)),r.always(h(!1))),G=k(m,r.always(h()),h),H=k(m,0,s(i,u)),K=k(m,h,s(p,u)),Q=t.zero,T=function(n){return function(r,t,e,u){return u(n,t)}},U=s(t.setOp,b),X=t.modifyOp(b),Y=T(void 0),Z=function(n){return function(r,t,e,u){return e.chain(function(n){return n?r:b(J||r)},function(n,r,t){try{return J=n(r,t)}catch(n){return J=n,!1}}(n,r,t))}},$=r.curry(function(n,r){return r=R(r),function(t,e,u,i){return u.chain(function(r){return O(r)?u.map(b,n(t,E(r),e)):r},r(t,e,u,i))}}),nn=r.curry(function(n,r){return W([t.rewrite(function(r){return O(r)?b(n):r}),r])}),rn=P(Q,R,function(n,r){return n=R(n),function(t,e,u,i){return u.chain(function(n){return O(n)?u.of(n):r(n,e,u,i)},n(t,e,u,i))}}),tn=P(X,R,function(n,r){return n=R(n),function(t,e,u,i){return u.chain(function(n){return O(n)?r(t,e,u,i):u.of(n)},n(t,e,u,i))}}),en=_({less:!0,rest:Q}),un=_({less:!1,rest:X}),on=r.curry(function(n,e){return n=R(n),function(o,c,f,a){return f.of(r.isFunction(o)?function(){for(var c=arguments.length,a=Array(c),s=0;s<c;s++)a[s]=arguments[s];return f.chain(function(n){return O(n)?i(u(E(n))):f.chain(function(u){return f.map(q,t.traverse(f,r.id,R(e.apply(null,n)),u))},o.apply(null,n))},t.traverse(f,r.id,n,a))}:b(o))}}),cn=r.curry(function(n,t){return on(n,r.always(t))}),fn=r.curry(function(n,r){return V(a,[t.setter(function(r,e){return O(r)?b(t.set(n,function(n,r,e){return void 0===(r=t.get(n,r))?t.get(n,e):r}(n,E(r),e),E(r))):r}),r])}),an=r.curry(function(n,r){return V(a,[N,t.branchOr(R(n),t.modify(t.values,R,r))])}),sn=an(X),ln=P(X,r.id(function(n,r){return 1===o(n)?n[0]:yn(n[0],n[1],r)}),r.id(function(n,r){return yn(n[0],n[1],r)})),yn=r.curry(function(n,r,t){return r=R(r),t=R(t),function(e,u,i,o){return i.chain(function(n){return n?r(e,u,i,o):t(e,u,i,o)},n(e,u))}}),dn=s(t.lazy,s(R));n.run=L,n.accepts=S,n.errors=B,n.validate=C,n.acceptsAsync=D,n.errorsAsync=G,n.tryValidateAsyncNow=H,n.validateAsync=K,n.accept=Q,n.acceptAs=T,n.acceptWith=function(n){return function(r,t,e,u){return e.chain(function(n){return u(n,t)},n(r,t))}},n.rejectWith=function(n){return function(r,t,e,u){return e.map(b,n(r,t))}},n.rejectAs=U,n.reject=X,n.remove=Y,n.where=Z,n.modifyError=$,n.setError=nn,n.and=rn,n.not=function(n){return W([t.setter(function(n,r){return O(n)?r:b(r)}),n])},n.or=tn,n.arrayId=function(n){return V(r.isArray,[M,t.elems,n])},n.arrayIx=function(n){return V(r.isArray,[I,t.elems,n])},n.args=en,n.tuple=un,n.dependentFn=on,n.freeFn=cn,n.keep=fn,n.optional=function(n){return W([t.optional,n])},n.propsOr=an,n.props=sn,n.cases=ln,n.ifElse=yn,n.choose=function(n){return function(r,t,e,u){return e.chain(function(n){return R(n)(r,t,e,u)},n(r,t))}},n.lazy=dn,Object.defineProperty(n,"__esModule",{value:!0})});
