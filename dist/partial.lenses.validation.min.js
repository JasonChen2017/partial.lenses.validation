!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("infestines"),require("partial.lenses")):"function"==typeof define&&define.amd?define(["exports","infestines","partial.lenses"],r):r(n.V={},n.I,n.L)}(this,function(n,r,t){"use strict";function e(n){this.value=void 0!==n?n:null}function u(n){var r=Error(JSON.stringify(n,null,2));return r.errors=n,r}function i(n){throw u(n)}var o=function(n){return n.length},c=r.curry(function(n,r){return n<=r}),f=r.curry(function(n,r){return r instanceof n}),a=f(Object),s=r.curry(function(n,r){return function(t){return n(r(t))}}),l=r.curry(function(n,r){return function(t){return n(t)&&r(t)}}),y=Promise,d=y.reject.bind(y),p=y.resolve.bind(y),h=function(n,t){return null!=t&&r.isFunction(t.then)?t.then(n):n(t)},v=r.id({map:h,ap:function(n,r){return h(function(r){return h(function(n){return n(r)},n)},r)},of:r.id,chain:h}),m={},w=function(n){return n===m?void 0:n},A=function(n){return void 0===n?m:n},g=t.rewrite(function(n){var r=F(n);return r&&(n=b(n)),n=n.map(w),r?O(n):n}),j=function(n,r,t,e){return t.map(A,e(n,r))},F=f(e),O=r.id(function(n){return new e(n)}),b=function(n){return n.value},N=function(n){return F(n)?b(n):void 0},E=function(n,r){return function(e){return t.any(F,n,e)?O(t.modify(n,r,e)):e}},x=t.rewrite(E(t.elems,function(n){return F(n)?b(n):null})),I=t.rewrite(E(t.elems,N)),z=t.rewrite(E(t.values,N)),M=function(n){return F(n)?i(u(b(n))):n},q=function(n,r,t){return function(){var e=arguments.length,u=n;if(e)for(u=r(arguments[--e],u);e;)u=t(arguments[--e],u);return u}},P=r.id(function(n){if(r.isFunction(n))return o(n)<3?rn(n):n;var t=n[1];return r.isFunction(t)?tn(t,n[0]):en(t,n[0])}),R=function(n,r){return t.ifElse(n,V(r),B)},V=s(t.toFunction,t.modify(t.elems,P)),W=function(n){var e=n.less,u=n.rest;return u=P(u),function(){for(var n=[],i=arguments.length,f=0;f<i;++f)n.push(P(arguments[f]));return R(e?r.isArray:l(r.isArray,s(c(i),o)),[g,x,e?function(n,r,e,u){var c=o(n);return c<i?((n=n.slice()).length=i,e.map(function(n){return t.any(F,t.elems,n)?n:n.slice(0,c)},t.elems(n,r,e,u))):t.elems(n,r,e,u)}:t.elems,j,t.choose(function(r,t){return n[t]||u})])}},_=function(n,r,t){return Q({Monad:n,onAccept:r,onReject:t})},k=m,C=t.zero,J=function(n){return function(r,t,e,u){return u(n,t)}},L=function(n){return function(r,t,e,u){return e.chain(function(n){return u(n,t)},n(r,t))}},S=s(t.setOp,O),B=t.modifyOp(O),D=J(void 0),G=r.always(B),H=function(n,r,t){return function(e,u){return n(e,u)?r:t(e,u)}},K=function(n){return r.curryN(2,function(r){return r=P(r),function(t){return t=P(t),n(r,t)}})},Q=r.curryN(3,function(n){var e=n.Monad||t.Identity,u=n.onAccept||r.id,o=n.onReject||i,c=function(n){return F(n)?o(b(n)):u(n)};return function(n){return n=P(n),function(u){return e.chain(c,t.traverse(e,r.id,n,u))}}}),T=_(0,r.always(!0),r.always(!1)),U=_(0,function(n){},r.id),X=_(),Y=_(v,r.always(p(!0)),r.always(p(!1))),Z=_(v,r.always(p()),p),$=_(v,0,s(i,u)),nn=_(v,p,s(d,u)),rn=function(n){return function(r,t,e,u){return e.chain(function(n){return n?r:O((k===m||(r=k,k=m),r))},function(n,r,t){try{return n(r,t)}catch(n){return k=n,!1}}(n,r,t))}},tn=r.curry(function(n,r){return r=P(r),function(t,e,u,i){return u.chain(function(r){return F(r)?u.map(O,n(t,b(r),e)):r},r(t,e,u,i))}}),en=r.curry(function(n,r){return V([t.rewrite(function(r){return F(r)?O(n):r}),r])}),un=r.curryN(2,function(n){return s(cn(n),L)}),on=r.curryN(2,function(n){return s(cn(n),J)}),cn=K(function(n,r){return function(t,e,u,i){return u.chain(function(n){return F(n)?u.of(n):r(n,e,u,i)},n(t,e,u,i))}}),fn=q(C,P,cn),an=K(function(n,r){return function(t,e,u,i){return u.chain(function(n){return F(n)?r(t,e,u,i):u.of(n)},n(t,e,u,i))}}),sn=q(B,P,an),ln=W({less:!0,rest:C}),yn=W({less:!1,rest:B}),dn=r.curry(function(n,e){return n=P(n),function(o,c,f,a){return f.of(r.isFunction(o)?function(){for(var c=arguments.length,a=Array(c),s=0;s<c;s++)a[s]=arguments[s];return f.chain(function(n){return F(n)?i(u(b(n))):f.chain(function(u){return f.map(M,t.traverse(f,r.id,P(e.apply(null,n)),u))},o.apply(null,n))},t.traverse(f,r.id,n,a))}:O(o))}}),pn=r.curry(function(n,t){return dn(n,r.always(t))}),hn=r.curry(function(n,r){return R(a,[t.setter(function(r,e){return F(r)?O(t.set(n,function(n,r,e){return void 0===(r=t.get(n,r))?t.get(n,e):r}(n,b(r),e),b(r))):r}),r])}),vn=r.curry(function(n,r){return R(a,[z,t.branchOr(P(n),t.modify(t.values,P,r))])}),mn=vn(B),wn=q(B,r.id(function(n,r){return 1===o(n)?n[0]:An(n[0],n[1],r)}),r.id(function(n,r){return An(n[0],n[1],r)})),An=r.curry(function(n,r,t){return r=P(r),t=P(t),function(e,u,i,o){return i.chain(function(n){return n?r(e,u,i,o):t(e,u,i,o)},n(e,u))}}),gn=r.id(function(n){n=t.toFunction(n);for(var e=arguments.length,u=G;--e;){var i=arguments[e];u=1===o(i)?r.always(P(i[0])):H(i[0],P(i[1]),u)}return function(r,e,i,o){return n(r,e,t.Constant,u)(r,e,i,o)}}),jn=s(t.lazy,s(P));n.accept=C,n.acceptAs=J,n.acceptWith=L,n.rejectWith=function(n){return function(r,t,e,u){return e.map(O,n(r,t))}},n.rejectAs=S,n.reject=B,n.remove=D,n.run=Q,n.accepts=T,n.errors=U,n.validate=X,n.acceptsAsync=Y,n.errorsAsync=Z,n.tryValidateAsyncNow=$,n.validateAsync=nn,n.where=rn,n.modifyError=tn,n.setError=en,n.modifyAfter=un,n.setAfter=on,n.removeAfter=function(n){return cn(n,D)},n.both=cn,n.and=fn,n.not=function(n){return V([t.setter(function(n,r){return F(n)?r:O(r)}),n])},n.either=an,n.or=sn,n.arrayId=function(n){return R(r.isArray,[I,t.elems,n])},n.arrayIx=function(n){return R(r.isArray,[x,t.elems,n])},n.args=ln,n.tuple=yn,n.dependentFn=dn,n.freeFn=pn,n.keep=hn,n.optional=function(n){return V([t.optional,n])},n.propsOr=vn,n.props=mn,n.choose=function(n){return function(r,t,e,u){return e.chain(function(n){return P(n)(r,t,e,u)},n(r,t))}},n.cases=wn,n.ifElse=An,n.casesOf=gn,n.lazy=jn,Object.defineProperty(n,"__esModule",{value:!0})});
